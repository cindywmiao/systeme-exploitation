#include <stdio.h>
#include <stdlib.h>
#include <assert.h>
#include <sys/time.h>
#include <signal.h>
#include <string.h>

#include "threadprio.h"



void timer_handler() {
    printf("timer handler (1sec)\n");
    thread_yield();
}

static void * threadfunc(void * arg)
{
  char *name = arg;
  printf("%s\n", name); 
}

int main(void)
{
  struct thread_t thread1, thread2,thread3;
  void *retval1, *retval2,*retval3;
  int err;

  lib_init();

  thread_setschedprio(&thread1,20);
  thread_setschedprio(&thread2,5);
  thread_setschedprio(&thread3,10);

  err = thread_create(&thread1, threadfunc, "thread1");
  assert(!err);
  
  err = thread_join(&thread1, &retval1);
  assert(!err);
  
  err = thread_create(&thread2, threadfunc, "thread2");
  assert(!err);

  err = thread_join(&thread2, &retval2);
  assert(!err);
  
  err = thread_create(&thread3, threadfunc, "thread3");
  assert(!err);
  
  err = thread_join(&thread3, &retval3);
  assert(!err);
 
 

  

    return EXIT_SUCCESS;
}
